<main id="megaverse">
  <div>
    <button class="metal linear" type="action" name="act_core">Core</button>
    <button class="metal linear" type="action" name="act_skills">Skills</button>
    <button class="metal linear" type="action" name="act_wp">WPs</button>
    <button class="metal linear" type="action" name="act_combat">Combat</button>
    <button class="metal linear" type="action" name="act_magic">Magic</button>
    <button class="metal linear" type="action" name="act_psionics">
      Psionics
    </button>
    <button class="metal linear" type="action" name="act_equipment">
      Equipment
    </button>
  </div>
  <input type="hidden" class="tabstoggle" name="attr_sheetTab" value="core" />

  <div class="core">
    Palladium Rifts Character Sheet <br />
    <h1>Character Statistics</h1>
    <div class="grid-container">
      <div class="section-one character-background">
        <label
          ><span>Character Name</span>
          <input
            id="character-name"
            type="text"
            value=""
            name="attr_character_name"
        /></label>
        <label
          ><span>True Name</span>
          <input type="text" value="" name="attr_truename_name"
        /></label>
        <label
          ><span>Race</span>
          <input type="text" value="" name="attr_character_race"
        /></label>
        <label
          ><span>O.C.C.</span> <input type="text" value="" name="attr_occ"
        /></label>
        <label
          ><span>Strength Type</span>
          <select class="" name="attr_ps_type" value="normal">
            <option value="normal">Normal</option>
            <option value="augmented">Augmented</option>
            <option value="robotic">Robotic</option>
            <option value="supernatural">Supernatural</option>
          </select></label
        >
        <label
          ><span>Level</span> <input type="number" name="attr_level"
        /></label>
        <label
          ><span>Experience</span> <input type="number" name="attr_experience"
        /></label>
        <label
          ><span>Alignment</span>
          <select class="select" name="attr_alignment_select" value="0">
            <option value="0"></option>
            <option value="Principled">Principled</option>
            <option value="Scrupulous">Scrupulous</option>
            <option value="Unprincipled">Unprincipled</option>
            <option value="Anarchist">Anarchist</option>
            <option value="Taoist">Taoist</option>
            <option value="Miscreant">Miscreant</option>
            <option value="Abberant">Aberrant</option>
            <option value="Diabolic">Diabolic</option>
          </select></label
        >
        <label
          ><span>Age</span>
          <input
            class="attribute"
            type="number"
            value=""
            name="attr_character_age"
        /></label>
        <label
          ><span>Gender</span>
          <input type="text" value="" name="attr_character_gender"
        /></label>
        <label
          ><span>Height</span>
          <input type="text" value="" name="attr_character_height"
        /></label>
        <label
          ><span>Weight</span>
          <input type="text" value="" name="attr_character_weight"
        /></label>
        <label
          ><span>Family Origin</span>
          <input type="text" value="" name="attr_character_familyorigin"
        /></label>
        <label
          ><span>Environment</span>
          <input value="" name="attr_character_environment"
        /></label>
        <label
          ><span>Native Language(s)</span>
          <input type="text" value="" name="attr_character_languages"
        /></label>
        <label
          ><span>Insanity, if any</span>
          <input type="text" value="" name="attr_character_insanity"
        /></label>
        <label
          ><span>Disposition</span>
          <input type="text" value="" name="attr_character_disposition"
        /></label>
      </div>

      <div class="section-two">
        <div class="ss-2a">
          <label for="iq">I.Q.</label>
          <input
            id="iq"
            type="number"
            value=""
            name="attr_iq"
            title="Intelligence Quotient"
          />
          <input
            class="attribute-bonus"
            type="number"
            value="0"
            name="attr_iq_bonus"
            title="+ Skills %"
            readonly
          />
          <input
            class="attribute-bonus"
            type="number"
            value="0"
            name="attr_perception_bonus"
            title="+ Perception (Rifter #13, p.16)"
            readonly
          />

          <label for="mental-endurance">M.E.</label>
          <input
            id="mental-endurance"
            type="number"
            value=""
            name="attr_me"
            title="Mental Endurance"
          />
          <input
            class="attribute"
            type="number"
            value="0"
            name="attr_me_bonus"
            title="+ Save vs. Psionics"
            readonly
          />
          <div></div>

          <label for="mental-affinity">M.A.</label>
          <input
            id="mental-affinity"
            type="number"
            value=""
            name="attr_ma"
            title="Mental Affinity"
          />
          <input
            type="number"
            value="0"
            name="attr_ma_bonus"
            title="% Trust/Intimidate"
            readonly
          />
          <div></div>

          <label for="physical-strength">P.S.</label>
          <input
            id="physical-strength"
            type="number"
            value=""
            name="attr_ps"
            title="Physical Strength"
          />
          <input
            class="attribute"
            type="number"
            value="0"
            name="attr_ps_bonus"
            title="+ SDC Damage"
            readonly
          />
          <div></div>

          <label for="physical-prowess">P.P</label>
          <input
            id="physical-prowess"
            type="number"
            value=""
            name="attr_pp"
            title="Physical Prowess"
          />
          <input
            class="attribute"
            type="number"
            value="0"
            name="attr_pp_bonus"
            title="+ Strike/Parry/Dodge/Entangle/Disarm"
            readonly
          />
          <div></div>

          <label for="physical-endurance">P.E.</label>
          <input
            id="physical-endurance"
            type="number"
            value=""
            name="attr_pe"
            title="Physical Endurance"
          />
          <input
            class="attribute"
            type="number"
            value="0"
            name="attr_pe_bonus"
            title="+ Magic/Poison/Toxins"
            readonly
          />
          <input
            class="attribute"
            type="number"
            value="0"
            name="attr_pe_coma_bonus"
            title="+ Coma/Death %"
            readonly
          />

          <label for="physical-beauty">P.B.</label>
          <input
            id="physical-beauty"
            type="number"
            value=""
            name="attr_pb"
            title="Physical Beauty"
          />
          <input
            class="attribute"
            type="number"
            value="0"
            name="attr_pb_bonus"
            title="% Charm/Impress"
            readonly
          />
          <div></div>

          <label for="speed">Spd</label>
          <input
            id="speed"
            type="number"
            value=""
            name="attr_spd"
            title="Speed"
          />
        </div>
        <div class="ss-2b">
          <label for="trust-intimidate">Trust/Intimidate</label>
          <input
            id="trust-intimidate"
            type="number"
            value=""
            name="attr_trust_intimidate"
          /><span>%</span>

          <label for="charm-impress">Charm/Impress</label>
          <input
            id="charm-imporess"
            type="number"
            value=""
            name="attr_charm_impress"
          /><span>%</span>
        </div>
        <div class="ss-2c">
          <label for="restrained-punch">Restrained Punch</label>
          <input
            id="restrained-punch"
            type="text"
            name="attr_restrained_punch"
          />
          <select name="attr_restrained_punch_unit" value="sdc">
            <option value="sdc">SDC</option>
            <option value="mdc">MDC</option>
          </select>

          <label for="punch">Punch</label>
          <input id="punch" type="text" name="attr_punch" />
          <select name="attr_punch_unit" value="sdc">
            <option value="sdc">SDC</option>
            <option value="mdc">MDC</option>
          </select>

          <label for="power-punch">Power Punch</label>
          <input id="power-punch" type="text" name="attr_power_punch" />
          <select name="attr_power_punch_unit" value="sdc">
            <option value="sdc">SDC</option>
            <option value="mdc">MDC</option>
          </select>

          <label for="kick">Kick</label>
          <input id="kick" type="text" name="attr_kick" />
          <select name="attr_kick_unit" value="sdc">
            <option value="sdc">SDC</option>
            <option value="mdc">MDC</option>
          </select>

          <label for="leap-kick">Leap Kick</label>
          <input id="leap-kick" type="text" name="attr_leap_kick" />
          <select name="attr_leap_kick_unit" value="sdc">
            <option value="sdc">SDC</option>
            <option value="mdc">MDC</option>
          </select>

          <label for="lift">Lift</label>
          <input id="lift" type="number" value="" name="attr_lift" />
          <div></div>

          <label for="carry">Carry</label>
          <input id="carry" type="number" value="" name="attr_carry" />
          <div></div>

          <label for="throw">Throw</label>
          <input id="throw" type="number" value="" name="attr_throw" />
          <div></div>

          <label for="carry-max">Carry Max</label>
          <input
            id="carry-max"
            type="number"
            value=""
            name="attr_carry_max"
          />Minutes

          <label for="carry-running">Carry (Running)</label>
          <input
            id="carry-running"
            type="number"
            value=""
            name="attr_carry_running"
          />Minutes

          <label for="hold-max">Hold Max.</label>
          <input
            id="hold-max"
            type="number"
            value=""
            name="attr_hold_max"
          />Melees
        </div>
      </div>
      <div class="section-three">
        <label for="hit-points">Hit Points</label>
        <input
          id="hit-points"
          type="number"
          value=""
          name="attr_character_hp"
        />
        <select
          class="select"
          name="attr_charactertype_select"
          value="0"
          style="width: 80px"
        >
          <option value="0"></option>
          <option value="sdc">S.D.C.</option>
          <option value="mdc">M.D.C.</option>
        </select>
        <input
          class="attribute"
          type="number"
          value=""
          name="attr_character_dc"
        />

        <label for="ppe">P.P.E.</label>
        <input id="ppe" type="number" value="" name="attr_character_ppe" />

        <label for="ar">A.R.</label>
        <input id="ar" type="number" value="" name="attr_character_ar" />

        <label for="isp">I.S.P.</label>
        <input id="isp" type="number" value="" name="attr_character_isp" />

        <label for="hf">H.F.</label>
        <input id="hf" type="number" value="" name="attr_character_hf" />

        <label for="initiative">Initiative</label>
        <div>
          <input
            id="initative"
            type="number"
            value="@{initiative}"
            disabled="true"
          />
          <button
            type="roll"
            value="Initiative: [[d20+@{initiative}+0.1*@{initiative}&{tracker}]]"
          >
            Roll
          </button>
        </div>

        <label for="perception">Perception</label>
        <div>
          <input id="perception" type="number" value"0" name="attr_perception"
          />
          <button type="roll" value="Perception: [[d20+@{perception}]]">
            Roll
          </button>
        </div>
      </div>
    </div>

    <h2>Movement</h2>
    <div class="movement-container">
      <div></div>
      <label for="mph">MPH</label>
      <label for="ft-melee">Ft/Melee</label>
      <label for="ft-attack">Ft/Attack</label>
      <label for="cruising">Cruising</label>
      <label for="run-at-max">Run at Max</label>
      <label>Run</label>
      <input id="mph" type="number" value="" readonly name="attr_run_mph" />
      <input
        id="ft-melee"
        type="number"
        value=""
        readonly
        name="attr_run_ft_melee"
      />
      <input
        id="ft-attack"
        type="number"
        value=""
        readonly
        name="attr_run_ft_attack"
      />
      <input id="cruising" type="number" value="" name="attr_run_cruising" />
      <div>
        <input
          id="run-at-max"
          type="number"
          value="@{pe}/2"
          disabled="true"
          name="attr_run_at_max"
        />
        minutes
      </div>

      <label for="leaing-distance">Leaping Distance</label>
      <input type="number" name="attr_leapup" value="" />
      <div>feet up?</div>
      <input type="number" name="attr_leapout" value="" />
      <div>feet out?</div>
      <div></div>

      <label>Additional Movement Type</label>
      <label>MPH</label>
      <label>Ft/Melee</label>
      <label>Ft/Attack</label>
      <label>Cruising</label>
      <label>Run at Max</label>

      <input type="text" value="" name="attr_movement_name" />
      <input type="number" value="" name="attr_movement_mph" />
      <input type="number" value="" name="attr_movement_ft_melee" />
      <input type="number" value="" name="attr_movement_ft_attack" readonly />
      <input type="number" value="" name="attr_movement_cruising" />
      <div>
        <input type="number" value="" name="attr_movement_at_max" /> minutes
      </div>
    </div>
  </div>
  <br />

  <div class="wp">
    <div class="wp-container">
      <h3>Ancient Weapon Proficiencies</h3>
      <fieldset class="repeating_wp">
        <h5>Weapon Proficiency</h5>
        <h5>Strike</h5>
        <h5></h5>
        <h5>Parry</h5>
        <h5></h5>
        <h5>Disarm</h5>
        <h5></h5>
        <h5>Throw</h5>
        <h5></h5>
        <h5>Entangle</h5>
        <h5></h5>
        <h5>RoF</h5>
        <h5>Level</h5>
        <input type="hidden" name="attr_combat_id" value="" />
        <input type="text" list="weaponProficiencies" name="attr_skill" />
        <datalist id="weaponProficiencies">
          <option value="Archery"></option>
          <option value="Axe"></option>
          <option value="Blunt"></option>
          <option value="Chain"></option>
          <option value="Forked"></option>
          <option value="Knife"></option>
          <option value="Grappling Hook"></option>
          <option value="Pole Arm"></option>
          <option value="Rope"></option>
          <option value="Shield"></option>
          <option value="Spear"></option>
          <option value="Staff"></option>
          <option value="Sword"></option>
          <option value="Targeting"></option>
          <option value="Whip"></option>
        </datalist>
        <input type="number" value="" name="attr_strike" />
        <button
          type="roll"
          value="@{wpname}: [[d20+@{strike}+@{combat_combined_strike}]]"
        ></button>
        <input type="number" value="" name="attr_parry" />
        <button
          type="roll"
          value="@{wpname}: [[d20+@{parry}+@{combat_combined_parry}]]"
        ></button>
        <input type="number" value="" name="attr_disarm" />
        <button
          type="roll"
          value="@{wpname}: [[d20+@{disarm}+@{combat_combined_disarm}]]"
        ></button>
        <input type="number" value="" name="attr_throw" />
        <button
          type="roll"
          value="@{wpname}: [[d20+@{throw}+@{combat_combined_throw}]]"
        ></button>
        <input type="number" value="" name="attr_entangle" />
        <button
          type="roll"
          value="@{wpname}: [[d20+@{entangle}+@{combat_combined_entangle}]]"
        ></button>
        <input type="number" value="" name="attr_rof" />
        <input type="number" value="" name="attr_skill_level" />
      </fieldset>
      <hr />
      <h3>Modern Weapon Proficiencies</h3>
      <fieldset class="repeating_wpmodern">
        <h5>Weapon Proficiency</h5>
        <h5>Strike</h5>
        <h5></h5>
        <h5>Burst</h5>
        <h5></h5>
        <h5>Level</h5>
        <input type="hidden" name="attr_combat_id" value="" />
        <input type="text" list="weaponProficienciesModern" name="attr_skill" />
        <datalist id="weaponProficienciesModern">
          <option value="Handguns"></option>
          <option value="Rifles"></option>
          <option value="Energy Heavy"></option>
          <option value="Energy Pistol"></option>
          <option value="Energy Rifle"></option>
          <option value="Heavy"></option>
          <option value="Speargun"></option>
          <option value="Shotgun"></option>
          <option value="Submachinegun"></option>
          <option value="Flamethrower"></option>
        </datalist>
        <input type="number" value="" name="attr_strike_range_single" />
        <button
          type="roll"
          value="@{wpname}: [[d20+@{strike_range_single}+@{combat_combined_strike_range}]]"
        ></button>
        <input type="number" value="" name="attr_burst" />
        <button
          type="roll"
          value="@{wpname}: [[d20+@{burst}+@{combat_combined_burst}]]"
        ></button>
        <input type="number" value="" name="attr_skill_level" />
      </fieldset>
    </div>
  </div>

  <div class="combat">
    <div class="combat-container">
      <div class="combat-combined">
        <details>
          <summary><b>Instructions</b></summary>
          <p>
            Complete the repeating sections for your various combat skills.
            Skill dropdowns are free-form, so you can type anything in them and
            don't need to select from the list. What's there is just a small
            sample.
          </p>
          <p>
            Any skills you add will appear as checkboxes. Toggling them will
            recalculate the bonuses for all checked items.
          </p>
          <p>
            Any Weapon Proficiencies you add on the WPs tab will appear on this
            page as well. Weapon Proficiencies <b>automatically</b> calculate
            their bonuses based on level, but no other skill (like Hand-to-Hand)
            does so yet.
          </p>
          <p>
            If you have additional bonuses from items, magic, training, etc.,
            you can create arbitrarily named sections and apply those as well.
          </p>
          <p>
            Note that PP bonus is added to Strike, Parry, Dodge, Throw, Disarm,
            Entangle, Dodge: Flight, Dodge: Auto, Dodge: Teleport, and Dodge:
            Motion. PS bonus isn't added to Damage because it could be
            non-Normal. Crit should be the lowest of the available options (ex.
            Crit: 17 is better than Crit: 19), but hasn't been implemented so
            needs to be set manually.
          </p>
        </details>
        <p>Click <b>Instructions</b> for detailed instructions.</p>
        <p>
          The Add/Modify buttons below will eventually disappear, as this
          section is dynamic. Unless you're using them for debugging or testing,
          don't touch them, as it may cause unpredictable behavior.
        </p>
        <fieldset class="repeating_combatselections">
          <label>
            <input type="checkbox" name="attr_skill_check" value="1" />
            <span name="attr_skill"></span
          ></label>
          <input type="hidden" name="attr_skill" value="" />
          <input type="hidden" name="attr_combat_id" value="" />
          <input type="hidden" name="attr_bonus_section" value="" />
        </fieldset>
        <br />
        <h3>Aggregated Bonuses</h3>
        <div class="combat-combined-bonuses">
          <label
            ><span>Attacks</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_attacks"
            />
          </label>
          <label
            ><span>Initiative</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_initiative"
            />
            <button
              type="roll"
              value="Initiative: [[d20+@{combat_combined_initiative}]]"
            />
          </label>
          <label
            ><span>Strike</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_strike"
            />
            <button
              type="roll"
              value="Strike: [[d20+@{combat_combined_strike}]]"
            />
          </label>
          <label
            ><span>Parry</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_parry"
            />
            <button
              type="roll"
              value="Parry: [[d20+@{combat_combined_parry}]]"
            />
          </label>
          <label
            ><span>Dodge</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_dodge"
            />
            <button
              type="roll"
              value="Dodge: [[d20+@{combat_combined_dodge}]]"
            />
          </label>
          <label
            ><span>Throw</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_throw"
            />
            <button
              type="roll"
              value="Throw: [[d20+@{combat_combined_throw}]]"
            />
          </label>
          <label
            ><span>Disarm</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_disarm"
            />
            <button
              type="roll"
              value="Disarm: [[d20+@{combat_combined_disarm}]]"
            />
          </label>
          <label
            ><span>Entangle</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_entangle"
            />
            <button
              type="roll"
              value="Entangle: [[d20+@{combat_combined_entangle}]]"
            />
          </label>
          <label
            ><span>Pull Punch</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_pull"
            />
            <button
              type="roll"
              value="Pull Punch: [[d20+@{combat_combined_pull}]]"
            />
          </label>
          <label
            ><span>Roll w/ Impact</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_roll"
            />
            <button
              type="roll"
              value="Roll w/ Impact: [[d20+@{combat_combined_roll}]]"
            />
          </label>
          <label
            ><span>Damage</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_damage"
            />
            <div></div>
          </label>
          <label
            ><span>Dodge: Flight</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_dodge_flight"
            />
            <button
              type="roll"
              value="Dodge in Flight: [[d20+@{combat_combined_dodge_flight}]]"
            />
          </label>
          <label
            ><span>Dodge: Auto</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_dodge_auto"
            />
            <button
              type="roll"
              value="Auto Dodge: [[d20+@{combat_combined_dodge_auto}]]"
            />
          </label>
          <label
            ><span>Dodge: Teleport</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_dodge_teleport"
            />
            <button
              type="roll"
              value="Teleport Dodge: [[d20+@{combat_combined_dodge_teleport}]]"
            />
          </label>
          <label
            ><span>Dodge: Motion</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_dodge_motion"
            />
            <button
              type="roll"
              value="Dodge in Motion: [[d20+@{combat_combined_dodge_motion}]]"
            />
          </label>
          <label
            ><span>Strike: Range</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_strike_range"
            />
            <button
              type="roll"
              value="Range Strike: [[d20+@{combat_combined_strike_range}]]"
            />
          </label>
          <label
            ><span>Range: Single</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_strike_range_single"
            />
            <button
              type="roll"
              value="Range Strike - Single Shot: [[d20+@{combat_combined_strike_range_single}]]"
            />
          </label>
          <label
            ><span>Burst</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_burst"
            />
            <button
              type="roll"
              value="Range Strike - Burst: [[d20+@{combat_combined_burst}]]"
            />
          </label>
          <label
            ><span>Critical</span>
            <input type="number" value="" name="attr_combat_combined_critical"
          /></label>
        </div>
        <hr />
        <h4>Saving Throws</h4>
        <div class="combat-combined-bonuses">
          <label
            ><span>Psionics</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_psionics"
            />
            <button
              type="roll"
              value="Save vs. Psionics: [[d20+@{combat_combined_psionics}]]"
            />
          </label>
          <label
            ><span>Magic</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_magic"
            />
            <button
              type="roll"
              value="Save vs. Magic: [[d20+@{combat_combined_magic}]]"
            />
          </label>
          <label
            ><span>Poison</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_poison"
            />
            <button
              type="roll"
              value="Save vs. Poison: [[d20+@{combat_combined_poison}]]"
            />
          </label>
          <label
            ><span>Horror Factor</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_horrorfactor"
            />
            <button
              type="roll"
              value="Save vs. Horror Factor: [[d20+@{combat_combined_horrorfactor}]]"
            />
          </label>
          <label
            ><span>Mind Control</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_mindcontrol"
            />
            <button
              type="roll"
              value="Save vs. Mind Control: [[d20+@{combat_combined_mindcontrol}]]"
            />
          </label>
          <label
            ><span>Disease</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_disease"
            />
            <button
              type="roll"
              value="Save vs. Disease: [[d20+@{combat_combined_disease}]]"
            />
          </label>
          <label
            ><span>Illusions</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_illusions"
            />
            <button
              type="roll"
              value="Save vs. Illusions: [[d20+@{combat_combined_illusions}]]"
            />
          </label>
          <label
            ><span>Possession</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_possession"
            />
            <button
              type="roll"
              value="Save vs. Possession: [[d20+@{combat_combined_possession}]]"
            />
          </label>
          <label
            ><span>Insanity</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_insanity"
            />
            <button
              type="roll"
              value="Save vs. Insanity: [[d20+@{combat_combined_insanity}]]"
            />
          </label>
          <label
            ><span>Torture</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_torture"
            />
            <button
              type="roll"
              value="Save vs. Torture: [[d20+@{combat_combined_torture}]]"
            />
          </label>
          <label
            ><span>Fatigue</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_fatigue"
            />
            <button
              type="roll"
              value="Save vs. Fatigue: [[d20+@{combat_combined_fatigue}]]"
            />
          </label>
          <label
            ><span>Toxins</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_toxins"
            />
            <button
              type="roll"
              value="Save vs. Toxins: [[d20+@{combat_combined_toxins}]]"
            />
          </label>
          <label
            ><span>Coma/Death</span>
            <input
              readonly
              type="number"
              value=""
              name="attr_combat_combined_comadeath"
            />
            <button
              type="roll"
              value="Save vs. Coma/Death: [[d100+@{combat_combined_comadeath}]]"
            />
          </label>
        </div>
      </div>
      <hr />
      <h3>Combat Skills</h3>
      <fieldset class="repeating_combat">
        <div class="bonus-type-container">
          <input type="hidden" name="attr_combat_selection_id" value="" />
          <label
            ><span>Skill</span>
            <input type="text" list="handToHand" name="attr_skill" />
            <datalist id="handToHand">
              <option value="Custom - Type Your Own"></option>
              <option value="Basic"></option>
              <option value="Expert"></option>
              <option value="Martial Arts"></option>
              <option value="Assassin"></option>
              <option value="Commando"></option>
              <option value="Dragon"></option>
              <option value="RPA Basic"></option>
              <option value="RPA Elite: Flying PA"></option>
              <option value="RPA Elite: Ground PA"></option>
              <option value="RPA Elite: Heavy Vehicle"></option>
              <option value="RPA Elite: Heavy Ground"></option>
              <option value="RPA Elite: Light Ground"></option>
              <option value="RPA Elite: Glitter Boy"></option>
              <option value="Spell: Superhuman Speed"></option>
              <option value="Psionic: Sixth Sense"></option>
              <option value="Magic Amulet: Charm"></option>
            </datalist>
          </label>
          <label
            ><span>Level</span>
            <input type="number" value="" name="attr_skill_level" />
          </label>
          <div></div>
          <div></div>
        </div>
        <details>
          <summary>
            <b>Expand <span name="attr_skill"></span></b>
          </summary>
          <div class="bonus-type-container">
            <label
              ><span>Attacks</span>
              <input type="number" value="" name="attr_attacks" />
            </label>
            <label
              ><span>Initiative</span>
              <input type="number" value="" name="attr_initiative" />
              <button type="roll" value="Initiative: [[d20+@{initiative}]]" />
            </label>
            <label
              ><span>Strike</span>
              <input type="number" value="" name="attr_strike" />
              <button type="roll" value="Strike: [[d20+@{strike}]]" />
            </label>
            <label
              ><span>Parry</span>
              <input type="number" value="" name="attr_parry" />
              <button type="roll" value="Parry: [[d20+@{parry}]]" />
            </label>
            <label
              ><span>Dodge</span>
              <input type="number" value="" name="attr_dodge" />
              <button type="roll" value="Dodge: [[d20+@{dodge}]]" />
            </label>
            <label
              ><span>Throw</span>
              <input type="number" value="" name="attr_throw" />
              <button type="roll" value="Throw: [[d20+@{throw}]]" />
            </label>
            <label
              ><span>Disarm</span>
              <input type="number" value="" name="attr_disarm" />
              <button type="roll" value="Disarm: [[d20+@{disarm}]]" />
            </label>
            <label
              ><span>Entangle</span>
              <input type="number" value="" name="attr_entangle" />
              <button type="roll" value="Entangle: [[d20+@{entangle}]]" />
            </label>
            <label
              ><span>Pull Punch</span>
              <input type="number" value="" name="attr_pull" />
              <button type="roll" value="Pull Punch: [[d20+@{pull}]]" />
            </label>
            <label
              ><span>Roll w/ Impact</span>
              <input type="number" value="" name="attr_roll" />
              <button type="roll" value="Roll w/ Impact: [[d20+@{roll}]]" />
            </label>
            <label
              ><span>Damage</span>
              <input type="number" value="" name="attr_damage" />
              <div></div>
            </label>
            <label
              ><span>Dodge: Flight</span>
              <input type="number" value="" name="attr_dodge_flight" />
              <button
                type="roll"
                value="Dodge in Flight: [[d20+@{dodge_flight}]]"
              />
            </label>
            <label
              >Dodge: Auto
              <input type="number" value="" name="attr_dodge_auto" />
              <button type="roll" value="Auto Dodge: [[d20+@{dodge_auto}]]" />
            </label>
            <label
              ><span>Dodge: Teleport</span>
              <input type="number" value="" name="attr_dodge_teleport" />
              <button
                type="roll"
                value="Teleport Dodge: [[d20+@{dodge_teleport}]]"
              />
            </label>
            <label
              ><span>Dodge: Motion</span>
              <input type="number" value="" name="attr_dodge_motion" />
              <button
                type="roll"
                value="Dodge in Motion: [[d20+@{dodge_motion}]]"
              />
            </label>
            <label
              ><span>Strike: Range</span>
              <input type="number" value="" name="attr_strike_range" />
              <button
                type="roll"
                value="Range Strike: [[d20+@{strike_range}]]"
              />
            </label>
            <label
              ><span>Range: Single</span>
              <input type="number" value="" name="attr_strike_range_single" />
              <button
                type="roll"
                value="Range Strike: [[d20+@{strike_range_single}]]"
              />
            </label>
            <label
              ><span>Range: Burst</span>
              <input type="number" value="" name="attr_burst" />
              <button type="roll" value="Range Strike: [[d20+@{burst}]]" />
            </label>
            <label
              ><span>Critical</span>
              <input type="number" value="" name="attr_critical"
            /></label>
          </div>
          <h4>Saving Throws</h4>
          <div class="bonus-type-container">
            <label
              ><span>Psionics</span>
              <input type="number" value="" name="attr_psionics" />
              <button
                type="roll"
                value="Save vs. Psionics: [[d20+@{psionics}]]"
              />
            </label>
            <label
              ><span>Magic</span>
              <input type="number" value="" name="attr_magic" />
              <button type="roll" value="Save vs. Magic: [[d20+@{magic}]]" />
            </label>
            <label
              ><span>Poison</span>
              <input type="number" value="" name="attr_poison" />
              <button type="roll" value="Save vs. Poison: [[d20+@{poison}]]" />
            </label>
            <label
              ><span>Horror Factor</span>
              <input type="number" value="" name="attr_horrorfactor" />
              <button
                type="roll"
                value="Save vs. Horror Factor: [[d20+@{horrorfactor}]]"
              />
            </label>
            <label
              ><span>Mind Control</span>
              <input type="number" value="" name="attr_mindcontrol" />
              <button
                type="roll"
                value="Save vs. Mind Control: [[d20+@{mindcontrol}]]"
              />
            </label>
            <label
              ><span>Disease</span>
              <input type="number" value="" name="attr_disease" />
              <button
                type="roll"
                value="Save vs. Disease: [[d20+@{disease}]]"
              />
            </label>
            <label
              ><span>Illusions</span>
              <input type="number" value="" name="attr_illusions" />
              <button
                type="roll"
                value="Save vs. Illusions: [[d20+@{illusions}]]"
              />
            </label>
            <label
              ><span>Possession</span>
              <input type="number" value="" name="attr_possession" />
              <button
                type="roll"
                value="Save vs. Possession: [[d20+@{possession}]]"
              />
            </label>
            <label
              ><span>Insanity</span>
              <input type="number" value="" name="attr_insanity" />
              <button
                type="roll"
                value="Save vs. Insanity: [[d20+@{insanity}]]"
              />
            </label>
            <label
              ><span>Torture</span>
              <input type="number" value="" name="attr_torture" />
              <button
                type="roll"
                value="Save vs. Torture: [[d20+@{torture}]]"
              />
            </label>
            <label
              ><span>Fatigue</span>
              <input type="number" value="" name="attr_fatigue" />
              <button
                type="roll"
                value="Save vs. Fatigue: [[d20+@{fatigue}]]"
              />
            </label>
            <label
              ><span>Toxins</span>
              <input type="number" value="" name="attr_toxins" />
              <button type="roll" value="Save vs. Toxins: [[d20+@{toxins}]]" />
            </label>
            <label
              ><span>Coma/Death</span>
              <input type="number" value="" name="attr_comadeath" />
              <button
                type="roll"
                value="Save vs. Coma/Death: [[d20+@{comadeath}]]"
              />
            </label>
          </div>
        </details>
      </fieldset>
    </div>
  </div>

  <div class="equipment">Equipment Coming Soon!</div>
  <div class="skills">Skills Coming Soon!</div>
  <div class="magic">Magic Coming Soon!</div>
  <div class="psionics">Psionics Coming Soon!</div>
</main>
<script type="text/javascript">
  // Change from javascript to worker before upload

  // DEFINITIONS
  // END DEFINITIONS

  // UTILS
  // END UTILS

  // COMBAT
  // END COMBAT

  // ATTRIBUTES
  // END ATTRIBUTES

  // SKILLS
  // END SKILLS

  /**
   * @todo combat row `level` needs to populate when `skill` does
   * @todo combat row `level` needs to adjust with Character level like WPs do
   * @todo Skills
   * @todo Magic - include checkbox beside each spell to add it as a row on the Combat tab
   * @todo Psionics - include checkbox beside each spell to add it as a row on the Combat tab
   * @todo consider spells/gear that modifies attributes (either as a modifier or an absolute value),
   *    modifies PS type,
   *
   * @todo better better build process with imports/file modules
   * */

  /**
   * This one could be a doozy
   * */
  on("change:level", (e) => {
    console.log("change:level", e.newValue, e.previousValue);
    // Update WPs
    updateWeaponProficiencies("wp", e.newValue, e.previousValue);
    updateWeaponProficiencies("wpmodern", e.newValue, e.previousValue);
  });

  on("change:repeating_movement:movement_mph", (e) => {
    getAttrs(["combat_combined_attacks"], (a) => {
      const feetPerMelee = Math.round((e.newValue * 5280) / 60 / 4);
      const attrs = {
        repeating_movement_movement_ft_melee: feetPerMelee,
        repeating_movement_movement_ft_attack: Math.round(
          feetPerMelee / a.combat_combined_attacks
        ),
      };
      setAttrs(attrs);
    });
  });

  on("change:repeating_movement:movement_ft_melee", (e) => {
    getAttrs(["combat_combined_attacks"], (a) => {
      const feetPerMelee = e.newValue;
      //const mph = Math.round((feetPerMelee * 4 * 60) / 5280);
      const mph = ((feetPerMelee * 4 * 60) / 5280).toFixed(1);
      const attrs = {
        repeating_movement_movement_mph: mph,
        repeating_movement_movement_ft_attack: Math.round(
          feetPerMelee / a.combat_combined_attacks
        ),
      };
      setAttrs(attrs);
    });
  });

  const buttonlist = [
    "core",
    "wp",
    "combat",
    "equipment",
    "skills",
    "magic",
    "psionics",
  ];
  buttonlist.forEach((button) => {
    on(`clicked:${button}`, function () {
      setAttrs({ sheetTab: button });
    });
  });
</script>
